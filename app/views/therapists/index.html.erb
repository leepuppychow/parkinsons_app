<div class="header">
  <h1>My Care Team
    <%= render partial: "partials/header"%>
  </h1>
</div>

<div class="column-container">
  <% current_user.doctors.each do |doctor|  %>
  <div class="healthprovider-box">
    <h2><%= doctor.name %> (<%= doctor.specialty %>)</h2>
    <%= doctor.location %></br>
    <%= doctor.phone %>
    <div class="appointments">
      <h4>Upcoming Appointments:</h4>
      <% doctor.current_appointments(current_user).each do |appointment|  %>
        <li>
          <%= appointment.date_time.strftime("%b %e, %Y --> %I:%M %p") %>
          <%= link_to "Edit", edit_patient_appointment_path(current_user, appointment) %>
          <%= link_to "Delete", patient_appointment_path(current_user, appointment), method: :delete %>
        </li>
      <% end %>
      <%= link_to "New Appointment", new_patient_appointment_path(current_user) %>
    </div>
    <div class="row-container">
      <%= form_for [current_user, doctor, doctor.note] do |f| %>
        <%= f.label "Notes:" %></br>
        <%= f.text_area :contents, class: "note-box" %></br>
        <%= f.submit "Update Note" %>
      <% end %>
      <%= link_to "Edit", edit_patient_doctor_path(current_user, doctor), method: :get, id: "edit-link" %>
      <%= link_to "Remove", patient_doctor_path(current_user, doctor), method: "delete", id: "delete-link"%>
    </div>
  </div>
  <% end  %>

  <%= link_to "New Doctor?", new_patient_doctor_path(current_user), id: "new-doctor" %>

  <% current_user.therapists.each do |therapist| %>
    <div class="healthprovider-box">
      <h2><%= therapist.name %> (<%= therapist.specialty %>)</h2>
      <%= therapist.location %></br>
      <%= therapist.phone %>
      <div class="appointments">
        <h4>Upcoming Appointments:</h4>
        <% therapist.current_appointments(current_user).each do |appointment|  %>
          <li>
            <%= appointment.date_time.strftime("%b %e, %Y --> %I:%M %p") %>
            <%= link_to "Edit", edit_patient_appointment_path(current_user, appointment) %>
            <%= link_to "Delete", patient_appointment_path(current_user, appointment), method: :delete %>
          </li>
          <%= link_to "New Appointment", new_patient_appointment_path(current_user) %>
        <% end %>
      </div>
      <div class="row-container">
        <%= form_for [current_user, therapist, therapist.note] do |f| %>
          <%= f.label "Notes:" %></br>
          <%= f.text_area :contents, class: "note-box"%></br>
          <%= f.submit "Update Note" %>
        <% end %>
        <%= link_to "Edit", edit_patient_therapist_path(current_user, therapist), method: :get, id: "edit-link" %>
        <%= link_to "Remove", patient_therapist_path(current_user, therapist), method: "delete", id: "delete-link"%>
      </div>
    </div>
  <% end %>

  <%= link_to "New Therapist?", new_patient_therapist_path(current_user), id: "new-therapist" %>
</div>
